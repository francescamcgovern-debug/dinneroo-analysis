# Dinneroo Zone Analysis - Task-Based Pipeline

## How This System Works

This is a **task-based analysis pipeline** following Denis Rothman's methodology:
- **AI as Augmentation** - Scripts do data processing, LLM adds reasoning and synthesis
- **Structured Approach** - Clear phases: Prepare â†’ Analyze â†’ Synthesize â†’ Iterate
- **Explainability** - Every score has documented evidence, every threshold is justified
- **Iterative Refinement** - Pipeline can re-run as data/requirements change

### On Every Request:

1. **Read this file first** (you're doing that now)
2. **Read relevant methodology** in `DOCUMENTATION/METHODOLOGY/`
3. **Run or reference scripts** in `scripts/`
4. **Check configuration** in `config/`
5. **Produce outputs** following standards

---

## Pipeline Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 DINNEROO ANALYSIS PIPELINE                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CONFIGURATION (config/)                                     â”‚
â”‚  â€¢ factor_weights.json - 10-factor weights (adjustable)     â”‚
â”‚  â€¢ mvp_thresholds.json - Zone MVP criteria                  â”‚
â”‚  â€¢ evidence_standards.json - Sample size requirements       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PHASE 1: DATA PREPARATION (scripts/phase1_data/)           â”‚
â”‚  01_load_sources.py      â†’ Load all data sources            â”‚
â”‚  02_extract_survey.py    â†’ Survey-backed scores             â”‚
â”‚  03_validate_data.py     â†’ Quality checks                   â”‚
â”‚  04_validate_config.py   â†’ Config evidence validation       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PHASE 2: ANALYSIS (scripts/phase2_analysis/)               â”‚
â”‚  01_score_dishes.py      â†’ 10-factor dish scoring           â”‚
â”‚  02_analyze_zones.py     â†’ Zone MVP status & gaps           â”‚
â”‚  03_segment_customers.py â†’ Family behavior patterns         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PHASE 3: SYNTHESIS (scripts/phase3_synthesis/)             â”‚
â”‚  01_generate_priority_list.py  â†’ Priority 100 Dishes        â”‚
â”‚  02_generate_zone_report.py    â†’ Zone MVP Report            â”‚
â”‚  03_export_dashboard_data.py   â†’ JSON for dashboards        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DELIVERABLES (docs/ for GitHub Pages)                      â”‚
â”‚  â€¢ Priority Dishes Dashboard                                 â”‚
â”‚  â€¢ Zone MVP Dashboard                                        â”‚
â”‚  â€¢ Executive Reports (MD)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Running the Pipeline

```bash
python scripts/run_pipeline.py --all        # Full pipeline
python scripts/run_pipeline.py --phase 1    # Data preparation only
python scripts/run_pipeline.py --phase 2    # Analysis only
python scripts/run_pipeline.py --dashboards # Update dashboards
```

---

## Core Rules

### 1. Evidence Standards
- ALWAYS cite sources with sample sizes: `(Source: X, n=Y)`
- ALWAYS indicate evidence level: ğŸ”µ Single | ğŸŸ¡ Corroborated | ğŸŸ¢ Validated
- NEVER make strategic recommendations from a single source
- See `DOCUMENTATION/METHODOLOGY/04_EVIDENCE_STANDARDS.md` for full standards

### 2. Two-Track Dish Scoring (Survivorship Bias Solution)
**Order volume shows what works among AVAILABLE options, not what families WANT.**

We use a **Two-Track Scoring System** to separate performance from opportunity:

| Track | Purpose | Data Sources |
|-------|---------|--------------|
| **Track A: Performance** | How well is this dish doing? | Orders, ratings, survey satisfaction |
| **Track B: Opportunity** | How much do families want this? | Latent demand, 10-factor fit, partner capability |

**Key Principle:** Unavailable dishes get Track B scores only - they're not penalized for having no orders.

- See `DOCUMENTATION/METHODOLOGY/01_DISH_SCORING.md` for full two-track methodology
- Rating threshold is **4.5** (not 4.0) to align with Deliveroo standards

### 3. Success Metrics Over Volume
**Success = families returning happy, not just ordering once.**
- Order volume is a survivorship bias metric - it shows activity, not success
- **Repeat Rate** (25% weight) is the PRIMARY success signal
- **Satisfaction/Rating** (25% weight) shows if families are happy
- Volume (10% weight) is LOWEST priority - only relevant after retention is healthy
- Use **Zone Health Score** (not Quality Score) to rank zones
- See `config/mvp_thresholds.json` for full weighting and `DOCUMENTATION/METHODOLOGY/02_ZONE_MVP.md` for methodology

**BLENDED Approach: Behavioral + Survey Data**
- Behavioral data (Snowflake): Repeat rate, star ratings, volume - shows what families DO
- Survey data (Post-Order): Satisfaction rate, kids happy rate - shows how families FEEL
- Triangulation provides more robust success signal than either source alone
- Fallback: If survey n < 20, use behavioral proxies

### 4. Strategic Positioning: Balanced Midweek Meals
**Dinneroo is designed for BALANCED MIDWEEK MEALS** - not indulgent weekend treats.
- Families want nutritious options they feel good about serving on a Tuesday
- "Balanced" = protein + veg + carbs in reasonable proportions
- Grilled chicken with customizable sides fits this positioning well
- When recommending dishes/partners, ask: "Does this fit the balanced midweek meal positioning?"

### 5. Dish Types, Not Brands
**Think about what families want to EAT, not specific partner names.**
- The question isn't "should we recruit Nando's?" - it's "do families want Grilled Chicken with Sides?"
- Dish-type thinking expands options (multiple partners can serve the same need)
- See `DOCUMENTATION/METHODOLOGY/01_DISH_SCORING.md` for the Dish Types Framework

### 6. Menu Gap Analysis
**The same partner may serve DIFFERENT items on Dinneroo vs regular Deliveroo.**
- âœ… Check `DATA/1_SOURCE/snowflake/DINNEROO_MENU_CATALOG.csv`
- âŒ Do NOT assume orders from a partner = items on Dinneroo menu

### 7. Config Validation (CRITICAL)
**Every cuisine or dish recommendation in config MUST be evidence-based.**

Before adding ANY recommendation to `config/mvp_thresholds.json`:
1. Check actual performance in `DATA/3_ANALYSIS/cuisine_performance.csv`
2. Verify repeat rate meets threshold (â‰¥15% for required, â‰¥15% for recommended)
3. Verify rating meets minimum (â‰¥4.0)
4. Add `source`, `evidence`, and `validated` fields

**Required fields for every recommendation:**
```json
{
  "cuisine": "Example",
  "reason": "Why this is recommended",
  "source": "cuisine_performance.csv",
  "evidence": {
    "order_count": 1000,
    "repeat_rate": 0.20,
    "avg_rating": 4.5
  },
  "validated": "2026-01-06"
}
```

**Run validation before committing config changes:**
```bash
python scripts/phase1_data/04_validate_config.py
```

The pipeline will FAIL if config contains unfounded recommendations.

### 8. MVP Criteria Consumer Validation (CRITICAL)
**MVP thresholds MUST be validated against consumer outcomes, not just order volume.**

Before presenting MVP criteria (cuisine count, partner count thresholds):
1. Run `scripts/phase2_analysis/04_validate_mvp_consumer_outcomes.py`
2. Verify consumer outcomes are linked to zone-level variety:
   - Kids full & happy rate by cuisine/partner bucket
   - Reorder intent by cuisine/partner bucket
   - Variety complaint rate by cuisine/partner bucket
3. All metrics must have sample sizes (n=X)
4. The pipeline will FAIL if `mvp_consumer_validation.json` is missing

**MVP Criteria Validation Checklist (MUST complete before presenting):**
- [ ] Kids happy rate by zone type calculated (5+ cuisines vs 3-4 vs 1-2)
- [ ] Reorder intent by zone type calculated
- [ ] Variety complaints by zone type calculated
- [ ] All metrics have sample sizes (n=X)
- [ ] Consumer validation data exists at `docs/data/mvp_consumer_validation.json`

**Why this matters:**
Order volume alone shows activity, not success. MVP criteria must prove that 5 cuisines/5 partners actually makes families happier and more likely to return - not just that they order more.

---

## 10-Factor Family Meal Framework

When prioritizing dishes, score against these 10 factors:

| Factor | Weight | Description |
|--------|--------|-------------|
| Kid-Friendly | 15% | Kids will actually eat it |
| Balanced/Guilt-Free | 12% | Parents feel good serving it |
| Adult Appeal | 8% | Adults enjoy it too |
| Portion Flexibility | 15% | Can feed 2 adults + 2 kids |
| Fussy Eater Friendly | 15% | Mild options available |
| Customisation | 10% | Individual preferences accommodated |
| Value at Â£25 | 10% | Worth it for family of 4 |
| Shareability | 5% | Family sharing at table |
| Vegetarian Option | 5% | Good veggie alternative |
| On Dinneroo Menu | 5% | Actually available |

**Weights are configurable** in `config/factor_weights.json`.

See `DOCUMENTATION/METHODOLOGY/01_DISH_SCORING.md` for full methodology.

---

## File Structure

```
NEW_PROJECT/
â”œâ”€â”€ .cursorrules                    â† You are here
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ factor_weights.json         â† Adjustable 10-factor weights
â”‚   â”œâ”€â”€ mvp_thresholds.json         â† Zone MVP criteria
â”‚   â””â”€â”€ evidence_standards.json     â† Sample size requirements
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ phase1_data/                â† Data loading scripts
â”‚   â”œâ”€â”€ phase2_analysis/            â† Analysis scripts
â”‚   â”œâ”€â”€ phase3_synthesis/           â† Report generation scripts
â”‚   â””â”€â”€ run_pipeline.py             â† One-command execution
â”œâ”€â”€ DOCUMENTATION/
â”‚   â”œâ”€â”€ METHODOLOGY/                â† How we analyze
â”‚   â”‚   â”œâ”€â”€ 01_DISH_SCORING.md      â† 10-factor methodology
â”‚   â”‚   â”œâ”€â”€ 02_ZONE_MVP.md          â† MVP criteria methodology
â”‚   â”‚   â”œâ”€â”€ 03_FAMILY_BEHAVIOR.md   â† Segmentation methodology
â”‚   â”‚   â””â”€â”€ 04_EVIDENCE_STANDARDS.md
â”‚   â””â”€â”€ CONTEXT/                    â† Background information
â”‚       â”œâ”€â”€ business_context.md
â”‚       â”œâ”€â”€ data_sources.md
â”‚       â””â”€â”€ definitions.md
â”œâ”€â”€ DATA/
â”‚   â”œâ”€â”€ 1_SOURCE/                   â† Raw data (DO NOT MODIFY)
â”‚   â”œâ”€â”€ 2_ENRICHED/                 â† Processed data
â”‚   â””â”€â”€ 3_ANALYSIS/                 â† Script outputs
â”œâ”€â”€ docs/                           â† GitHub Pages
â”‚   â”œâ”€â”€ dashboards/                 â† Dynamic HTML dashboards
â”‚   â””â”€â”€ data/                       â† JSON data for dashboards
â””â”€â”€ DELIVERABLES/
    â””â”€â”€ reports/                    â† Markdown reports
```

---

## What NOT to Do

âŒ Make up data or replicate old findings
âŒ Use a single data source for strategic recommendations
âŒ Use OG Survey ALONE for dish recommendations
âŒ Weight any source > 50%
âŒ Report findings without sample sizes
âŒ Use "significant" without a p-value
âŒ Modify files in `DATA/1_SOURCE/`
âŒ Assume previous findings are still valid
âŒ **Assume top-selling dishes = what families want (survivorship bias)**
âŒ **Skip latent demand analysis when recommending dishes**
âŒ **Think in brand names instead of dish types**
âŒ **Assume orders from a partner = Dinneroo menu items**
âŒ **Add cuisine/dish recommendations to config without source citation**
âŒ **Add recommendations without validating against performance data**
âŒ **Assume "kid-friendly" or "familiar" = good for Dinneroo without evidence**

---

## Anti-Replication Rules

**Do NOT assume from previous analysis:**
- Which dishes are "winners" or "losers"
- Which zones are "high performing" or "low performing"
- Which partners are "best" or "worst"
- Which cuisines are "essential" or "nice-to-have"

**Every insight must come from fresh analysis of the current data.**

If you find yourself writing something like "Pizza is a top performer" without having just calculated it from the data, STOP and run the analysis first.

---

## LLM Capabilities to Use

Use LLM for:
1. **Theme Extraction** - Analyze open-text responses to discover patterns
2. **Gap Identification** - Compare high vs low performers to find differences
3. **Recommendation Generation** - Synthesize data into actionable recommendations
4. **Cross-Source Synthesis** - Combine insights from multiple data sources
5. **Smart Discovery** - Identify dishes that existing partners COULD make (Track B Opportunity scoring)

Do NOT use LLM to:
- Make up data
- Replicate old findings without fresh analysis
- Skip the evidence standards
- Score unavailable dishes based on performance (use Track B instead)

---

## Getting Started

1. Run `python scripts/run_pipeline.py --list` to see available scripts
2. Run `python scripts/run_pipeline.py --all` for full analysis
3. Check `docs/` for dashboards
4. Check `DELIVERABLES/reports/` for reports

---

*This pipeline is designed for reproducible, evidence-based analysis. Let the data tell the story.*
